<!DOCTYPE html>
<html lang="ru"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><title>Почему я не использую CSS nesting и вам не советую - Борьба с дизайном</title><link rel="stylesheet" href="/webval-blog/assets/main.css">
  <link rel="stylesheet" href="/webval-blog/Styles/my-styles.css">
  <link rel="icon" sizes="16x16" href="/webval-blog/Icons/favicon.ico">
  <link rel="icon" sizes="32x32" href="/webval-blog/Icons/favicon.ico"><link type="application/atom+xml" rel="alternate" href="https://vallek.github.io/webval-blog/feed.xml" title="Борьба с дизайном" /></head>
<body><header class="site-header">

  <div class="wrapper header-wrapper"><a class="site-title" rel="author" href="/webval-blog/">Борьба с дизайном</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/webval-blog/about/index.html">Обо мне</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper main-wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Почему я не использую CSS nesting и вам не советую</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-02-22T00:00:00+03:00" itemprop="datePublished">Feb 22, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>В Хроме и бете Сафари (на момент написания) <a href="https://caniuse.com/css-nesting">появился</a> нативный CSS nesting, то есть возможность вкладывать одни css правила в другие, подобно тому, как это позволяют делать препроцессоры вроде SCSS. О том, почему я не большой поклонник этой фичи читайте далее:)</p>

<p>CSS нестинг противоречит практике разделения разметки/структуры HTML и стилизации CSS, что в свою очередь увеличивает связанность кода, делает код менее читаемым и решает задачи, которые уже решают другие подходы без вышеперечисленных проблем. Давайте разберем каждый пункт.</p>

<h2 id="связанность">Связанность</h2>
<p>Про связанность кода часто говорят в контексте внутри самого CSS, когда речь идет об использовании слишком общих селекторов по элементам и вложенности селекторов. Например, селектор <code class="highlighter-rouge">.some-list a</code> может выглядеть безобидно сегодня, но завтра окажется, что в каждом пункте меню не один тип ссылок, а несколько.</p>

<p>Примерно та же проблема возникает, когда мы тянем структуру страницы из HTML в CSS. Посмотрим на <a href="https://webkit.org/blog/13813/try-css-nesting-today-in-safari-technology-preview/">пример</a> от создателей <del>нового Internet Explorer</del> Safari:</p>

<p><img src="/webval-blog/Images/css-nesting-1.png" alt="скриншот кода" /></p>

<p>Предполагается, что у нас есть некий компонент со списком внутри. Мы хотим задать внутренний отступ всем спискам и убрать отступ по умолчанию у списка внутри компонента.</p>

<p>Я вижу несколько проблем предлагаемого решения:</p>

<ol>
  <li>У списка компонента нет класса. Это может привести к проблемам в будущем. Если что-то поменяется в структуре (в компоненте появится другой список) придется переписывать правило. Но если бы у этих списков был свой класс вся эта конструкция была бы не нужна в принципе (заглянувшие в теги могут догадаться, к чему я веду:)</li>
  <li>Собственно, абсолютно все примеры улучшения css нестингом, которые я видел, состоят из совершенно кошмарного изначально кода, вроде такого:<br />
<img src="/webval-blog/Images/css-nesting-4.png" alt="" /><br />
Да, это не совсем проблема нестинга, но если это единственное, что можно им улучшить, то возможно стоит сначала взяться за изначальные проблемы.</li>
  <li>Из этого css непонятно, можно ли будет использовать этот список вне компонента. Если да, то опять же это создаст дополнительную работу.</li>
</ol>

<h2 id="читаемость">Читаемость</h2>

<p>При использовании нестинга (с любой реализацией), страдает читаемость кода. В обычном CSS правиле есть только два уровня индентации. Верхний с селектором и внутренний со свойствами. Это позволяет максимально быстро пробежать глазами по коду, легко считать и найти нужное. А что с нестингом?</p>

<ol>
  <li>С нестингом вы не знаете заранее, что именно будет стоять на внутреннем отступе: свойство или селектор. Мозгу сложнее отделять строки. Конечно, это отчасти решается подсветкой синтаксиса, но сокращает способы считываемости.</li>
  <li>Кроме того вложенность может обозначаться в любую сторону (как в первом примере). Что еще больше увеличивает нагрузку на мозг.</li>
  <li>А еще можно вкладывать многоуровневые медиа-запросы. Посмотрите на этот ужас из спецификации:<br />
<img src="/webval-blog/Images/css-nesting-2.png" alt="" /><br />
Представьте, что вам нужно убрать правило для ориентации экрана, но оставить для ширины. Где это сделать будет быстрее?</li>
</ol>

<p>В целом я не вижу причин не следовать и здесь золотому правилу “не усложняйте без необходимости”)</p>

<h2 id="решение">Решение</h2>

<p>Решение всех этих и многих других проблем уже давно известно и многими в разной форме используется. Это методологии именования классов. Одна из них - БЭМ, которую я использую и могу посоветовать вам. Впрочем, какую именно методологию использовать не так важно, как принципы, на которые они обычно опираются.</p>

<p>Один из таких принципов - давать уникальные классы всем уникальным сущностям. Я не буду здесь углубляться в то, как именно это делается по БЭМу вы можете почитать про это сами <a href="https://vallek.github.io/web-links/index.html#bem">по ссылкам в моей подборке</a> или даже попасть на <a href="https://vallek.github.io/pages/projects/bem.html">мою лекцию</a>, если она проводится.</p>

<p>Но пока просто предлагаю сравнить два примера:</p>

<pre>
	ul {
	  padding-left: 1em;
	  .component &amp; {
	    padding-left: 0;
	  }
	}
</pre>

<pre>
	ul {
		padding-left: 1em;
	}
	.component__list {
		padding-left: 0;
	}
</pre>

<p>Какой из них проще понять? Какой будет проще переиспользовать и какой вызовет меньше проблем в будущем?</p>

<p>Методология решает все вышеперечисленные проблемы. Специфичность и каскад не вызовут проблем, если использовать уникальные селекторы без вложенности. Подробнее о решении этих проблем по БЭМу можно <a href="https://ru.bem.info/methodology/solved-problems/">почитать в доках</a>.</p>

<p>Тут стоит отметить, что хотя БЭМ допускает применение каскада, но использовать его без крайней необходимости не рекомендуется. Нестинг же по сути построен на предположении, что каскад через вложенные селекторы используется регулярно.</p>

<p>“А как же правило для всех списков?” - спросите вы - “это ведь не по БЭМу”. Да, таких общих стилей лучше избегать. Но, если речь идет об одном селекторе по тегу, то правила с классом его перепишут, так что это не самое страшное, что можно сделать. В целом же БЭМ это не высеченные в граните заповеди, а принципы. Они могут принести пользу, но только, если перед их использованием подумать, что и зачем вы делаете.</p>

<p>Но главное отличие этих подходов с моей точки зрения можно выразить так: нестинг тащит структуру в стили, методология же следует задачам. Поэтому с БЭМом, как ни странно, проще понять, о какой структуре идет речь, не заглядывая в html. Ведь классы описывают ее семантически.</p>

<p>Конечно, нет смысла использовать БЭМ, не думая заранее, что и где нужно будет переиспользовать. И, да, задачи могут поменяться. Но рефакторить элементы в блоки по-моему полегче, чем пытаться переиспользовать вот это чудо:</p>

<p><img src="/webval-blog/Images/css-nesting-3.png" alt="" /></p>

<p>На всякий случай добавлю, что все вышесказанное относится к любому нестингу, не только нативному, но и из препроцессоров. Просто с распространением натива, наверняка еще больше разработчиков станет все это использовать. И возможно есть задачи, в которых нестинг может чем-то помочь, как и любая другая технология. Я всего-лишь хочу предостеречь от бездумного хватания за этот синтаксис по умолчанию. Вот и весь хот тейк, а кто скушал молодец)</p>

    <aside class="categories-sidebar">
      <!-- <h2 class="aside-heading">Другие статьи по теме:</h2>
      
      <h3>веб</h3>
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2022/06/02/fix-svg-favicon-error.html">Как исправить ошибку валидатора для инлайновой svg фавиконки с эмоджи</a></li>
      </ul>
      
      
      
      
      
      <ul>
        <li><a href="/2021/06/14/reduce-motion-problem.html">Проблема с системной настройкой reduced motion</a></li>
      </ul>
      
      
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2019/07/19/bem-terms-problem.html">Проблема терминов БЭМа</a></li>
      </ul>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <h3>css</h3>
      
      
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2021/06/14/reduce-motion-problem.html">Проблема с системной настройкой reduced motion</a></li>
      </ul>
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2020/05/07/layout-translation.html">Layout по-русски</a></li>
      </ul>
      
      
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2018/08/26/vs-code-syntax-highlight.html">Как изменить цвета подсветки синтаксиса в VS Code</a></li>
      </ul>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2018/05/09/css-tricks-images-in-letters.html">CSS-трюки: Несколько изображений внутри букв без фотошопа</a></li>
      </ul>
      
      
      
      
      
      
      
      
      <h3>nesting</h3>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <h3>бэм</h3>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <ul>
        <li><a href="/2019/07/19/bem-terms-problem.html">Проблема терминов БЭМа</a></li>
      </ul>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
       -->

      <h2 class="aside-heading">Тэги:</h2>
      <span>
        
          
          <a class="tag-link" href="/webval-blog/tag/веб"><nobr>веб</nobr></a>
        
          
          <a class="tag-link" href="/webval-blog/tag/css"><nobr>css</nobr></a>
        
          
          <a class="tag-link" href="/webval-blog/tag/nesting"><nobr>nesting</nobr></a>
        
          
          <a class="tag-link" href="/webval-blog/tag/бэм"><nobr>бэм</nobr></a>
        
      </span>
    </aside>
  </div>

  <a class="u-url" href="/webval-blog/2023/02/22/css-nesting.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <a class="u-url" href="/webval-blog/"></a>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-3 footer-info">
        <ul class="contact-list">
          <li>Почта: <a class="u-email" href="mailto:vwebdis@gmail.com">vwebdis@gmail.com</a></li>
          <li>Собрано на <a href="https://jekyllrb.com/">Jekyll</a></li>
        </ul>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
